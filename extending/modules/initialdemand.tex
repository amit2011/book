% ####################################################################################################
\section{Initial Demand Generation}
\label{sec:extending-initial-demand}

\kaitodo{chk initial demand generation section}

Section~\ref{sec:buildingbasicscenario} introduced the elements required for a basic \gls{matsim} scenario. 
Part~IV will show how initial demand was generated on a practical level---\eg data used---for different scenarios. 
This section presents \gls{matsim}'s technical tools for initial demand generation. 
Different from the single modules' description of the previous sections of this chapter, here, functionality is achieved by combining different modules. 

Entry point are following parsimonious example scripts, which can be adapted to generate the initial demand for a specific geographical region. The scripts can be found in package \lstinline|tutorial.programming.example08DemandGeneration|; alternatively, see \url{http://matsim.org/javadoc} $\to$ core:
\begin{lstlisting}
class RunPNetworkGenerator
\end{lstlisting} 
generating a \gls{matsim} network derived from \gls{osm}, and
\begin{lstlisting}
class RunPOnePersonPopulationGenerator, 
class RunPPopulationGenerator
\end{lstlisting}
generating a one agent and a 20\,agents population, respectively, and writing them to files, and, 
\begin{lstlisting}
class RunZPopulationGenerator
\end{lstlisting} 
generating a sample population from a census file and writing it to a file.

\kai{folgendes ist irgendwie immer noch unsortiert.  Vielleicht besser irgendwo anders beschreiben?}

These ``scripts'' build on utility classes such as \lstinline|class PopulationUtils| providing factory functionality 
%by public and static methods 
%Im Java-Sinne sind die m.E. nicht statcs, aber eigentlich tut es auch nichts zur Sache. kai, apr'15
to create and manipulate elements of the module containing respective utility class. \lstinline|PopulationUtils| for example has a \lstinline|createPopulation(...)| method.

Utility classes are usually named \lstinline|*Utils|. 
Following utils exist
\lstinline|ConfigUtils|,
\lstinline|NetworkUtils|,
\lstinline|PopulationUtils|,
\lstinline|ScenarioUtils|,
\lstinline|ControlerUtils|,
\lstinline|FacilitiesUtils|,
\lstinline|VehicleUtils|,
%
\lstinline|EventsUtils|,
\lstinline|CharyparNagelScoringUtils|,
\lstinline|LanesUtils|,
\lstinline|QSimUtils|,
%
\lstinline|SignalUtils|,
\lstinline|TripStructureUtils|,
(\lstinline|ObjectAttributesUtils|), and
(\lstinline|VectorUtils|).
Furthermore, there are geometry factories contained in package \lstinline|geometry|, such as \lstinline|TransformationFactory|.

%%\kaitodo{we need something about how to use extensions}
% this is in ``Using One or More Contribs''. kai, jul'15

% ####################################################################################################
%\subsubsection{Utils}
%\ah{
%This is maybe better somewhere in Chapter~\ref{ch:extensionpoints}.
%They are not really extension points but something similar helpful for scripting.
%}
%%
%\kai{I would (strongly) vote for Chapter~\ref{ch:extensionpoints}.  ``writing scripts in java'' is a forward reference, and details should go to where it points to.  It is indeed not an ``extension point'', but something like an ``extension programming survival tool''.}

%\ah{moved this up}

% ----------------------------------------------------------------

%\kai{
%Hallo Andreas,
 %
 %Haben wir irgendwo im Buch etwas über ``initial input generation'' (also network.xml und plans.xml)?
 %
 %Ich finde etwas in 2.2, aber das war es dann auch.
 %
 %Irgendwie finde ich aber doch, dass wir wenigstens minimale Hinweise auf
 %
 %RunPNetworkGenerator
 %RunPOnePersonPopulationGenerator
 %
 %geben sollten.
 %
 %M.E. sind das auch ``scripts-in-java'', und damit auch Kap.32.
 %
 %Das wäre dann m.E. noch vor 32.2.1, also neu
 %
 %32.2.1 initial demand generation
 %
 %32.2.2 config group
 %
 %Oder?
 %
 %VG Kai
%}
%
%\ah{Stimmt. Ich hatte früher auch mal Kirills Popgen auf dem Schirm, dann aber Initial Demand Generation irgendwie etwas verdrängt, weil es inhaltlich durch die Szenarien abgedeckt ist. Technisch aber natürlich nicht, werde mich die nächsten Tage daran versuchen.
%}
%
%\kai{
%Danke.  M.E. kann das eher kurz sein, mit Verweis auf die Beispiele.
%
%Ist aber der Ort, wo (m.E.) die Factories erklärt werden müssen.
%
%VG
%
%Kai
%}
